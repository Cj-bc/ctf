from Crypto.Util.number import bytes_to_long
import random

# N = 82212154608576254900096226483113810717974464677637469172151624370076874445177909757467220517368961706061745548693538272183076941444005809369433342423449908965735182462388415108238954782902658438063972198394192220357503336925109727386083951661191494159560430569334665763264352163167121773914831172831824145331
# e = 3
FLAG = bytes_to_long(open('flag', 'rb').read())

# Shift for [0,1,2] times.
# We don't have to care about contents of FLAG, as it's divided by 4.
r = 1 << random.randrange(0, FLAG.bit_length() // 4)
C = pow(FLAG ^ r, 3, 82212154608576254900096226483113810717974464677637469172151624370076874445177909757467220517368961706061745548693538272183076941444005809369433342423449908965735182462388415108238954782902658438063972198394192220357503336925109727386083951661191494159560430569334665763264352163167121773914831172831824145331)

print(C)

